---
title: "MP01"
format: html
theme: cosmo
code-fold: true
---

With notable releases including Squid Games Season 2, Wednesday Season 2, and the animated premiere of KPOP Demon Hunters, 2025 has been a huge year for Netflix. There is no slowing down of this momentum. Netflix's success is only expected to increase as the much awaited Stranger Things final season approaches.

Let's examine the popular programming from the previous few years in more detail

```{r}
if(!dir.exists(file.path("data", "mp01"))){
  dir.create(file.path("data", "mp01"), showWarnings=FALSE, recursive=TRUE)
}

GLOBAL_TOP_10_FILENAME <- file.path("data", "mp01", "global_top10_alltime.csv")

if(!file.exists(GLOBAL_TOP_10_FILENAME)){
  download.file("https://www.netflix.com/tudum/top10/data/all-weeks-global.tsv", 
                destfile=GLOBAL_TOP_10_FILENAME)
}

COUNTRY_TOP_10_FILENAME <- file.path("data", "mp01", "country_top10_alltime.csv")

if(!file.exists(COUNTRY_TOP_10_FILENAME)){
  download.file("https://www.netflix.com/tudum/top10/data/all-weeks-countries.tsv", 
                destfile=COUNTRY_TOP_10_FILENAME)}
```

# Task 1: Lets load and import packages

```{r}
if(!require("tidyverse")) install.packages("tidyverse")
library(readr)
library(dplyr)

GLOBAL_TOP_10 <- read_tsv(GLOBAL_TOP_10_FILENAME)
```

# Task 2: Data Cleaning

Replacing all the ‘N/A’ values with NA in the season_title column

```{r}
library(dplyr)

GLOBAL_TOP_10 <- GLOBAL_TOP_10 |>
    mutate(season_title = if_else(season_title=="N/A", NA, season_title))
```

```{r}
glimpse(GLOBAL_TOP_10)
```

# Task 3: Data Import

```{r}
COUNTRY_TOP_10 <- read_tsv(COUNTRY_TOP_10_FILENAME, na = "N/A")
```

```{r}
if(!require("DT"))
library(DT)
```

```{r}
GLOBAL_TOP_10 |> 
  head(n=20) |>
  datatable(options=list(searching=FALSE, info=FALSE))
```

```{r}
#creating a function to edit column names 
library(stringr)
format_titles <- function(df){
  colnames(df) <- str_replace_all(colnames(df), "_", " ") |> str_to_title()
  df}

# using the function we made, adding commas to large numbers and dropping 
# a column and changing runtime from hour to minutes
GLOBAL_TOP_10 |> 
  mutate(`runtime_(minutes)` = round(60 * runtime)) |>
  select(-season_title, -runtime) |>
  format_titles() |>
  head(n=20) |>
  datatable(options=list(searching=FALSE, info=FALSE)) |>
  formatRound(c('Weekly Hours Viewed', 'Weekly Views'))
```

# TASK 4: EDA

Question 1: **How many different countries does Netflix operate in?**

```{r}
# Question 1
library(dplyr)
COUNTRY_TOP_10 |>
    summarise(n_countries = n_distinct(country_name))
```

Question 2: **Which non-English-language film has spent the most cumulative weeks in the global top 10? How many weeks did it spend?**

```{r}
# Question 2
GLOBAL_TOP_10 |>
  filter(category == 'Films (Non-English)') |>
  filter(cumulative_weeks_in_top_10 == max(cumulative_weeks_in_top_10))|>
  select(show_title, cumulative_weeks_in_top_10) |>
  slice_max(cumulative_weeks_in_top_10)
```

Question 3: **What is the longest film (English or non-English) to have ever appeared in the Netflix global Top 10? How long is it in minutes?**

```{r}
# Question 3
GLOBAL_TOP_10 |> 
  mutate(runtime_in_minutes = round(60 * runtime)) |>
  filter(category == 'Films (English)' | category == 'Films (Non-English)') |>
  select(category, show_title, runtime_in_minutes) |>
  slice_max(runtime_in_minutes)
```

Question 4: **For each of the four categories, what program has the most total hours of global viewership?**

```{r}
# question 4
GLOBAL_TOP_10 |> 
  filter(category %in% c('Films (English)', 'Films (Non-English)', 'TV (Non-English)', 'TV (English)')) |>
  group_by(category, show_title) |>
  summarise(total_hours_view = sum(weekly_hours_viewed)) |>
  slice_max(total_hours_view) |>
  datatable(options=list(searching=FALSE, info=FALSE))|>
  formatRound(c('total_hours_view'))
```

Question 5: **Which TV show had the longest run in a country’s Top 10? How long was this run and in what country did it occur?**

```{r}
# question 5
COUNTRY_TOP_10 |>
  filter(category == 'TV') |>
  filter(cumulative_weeks_in_top_10 == max(cumulative_weeks_in_top_10)) |>
  select(country_name, show_title, longest_run_in_weeks = cumulative_weeks_in_top_10)
```

Question 6: **Netflix provides over 200 weeks of service history for all but one country in our data set. Which country is this and when did Netflix cease operations in that country?**

```{r}
# question 6
COUNTRY_TOP_10 |>
  group_by(country_name) |>
  summarise(week_count = n_distinct(week),
            last_week = max(week)) |>
  filter(week_count <= 200)
```

Question 7: **What is the total viewership of the TV show *Squid Game*?**

```{r}
# question 7
squid_game_hours <- GLOBAL_TOP_10 %>%
  filter(show_title == "Squid Game") %>%
  summarise(total_hours = sum(weekly_hours_viewed, na.rm=TRUE))

datatable(squid_game_hours, options = list(searching = FALSE, info = FALSE))
```

Question 8: **The movie *Red Notice* has a runtime of 1 hour and 58 minutes. Approximately how many views did it receive in 2021?**

```{r}
# question 8
GLOBAL_TOP_10 |>
  filter(year(week)== 2021) |>
  filter(show_title == 'Red Notice') |>
  summarise(total_hours_watched = sum(weekly_hours_viewed)) |> 
  summarise(view_count = total_hours_watched/(118/60))
```

Question 9: **How many Films reached Number 1 in the US but did not originally debut there? That is, find films that first appeared on the Top 10 chart at, *e.g.*, Number 4 but then became more popular and eventually hit Number 1? What is the most recent film to pull this off?**

```{r}
# question 9
us_films <- COUNTRY_TOP_10 |>
  filter(country_name == "United States") |>
  group_by(show_title) |>
  summarise(
    debut_rank = first(weekly_rank),           
    first_week = first(week),                
    ever_number1 = any(weekly_rank == 1),     
    last_week_number1 = ifelse(
      any(weekly_rank == 1),
      max(week[weekly_rank == 1], na.rm = TRUE),
      as.Date(NA)
    ),
    .groups = "drop"
  ) |>
  filter(debut_rank > 1 & ever_number1)     

# Number of films
num_films <- nrow(us_films)

# Most recent film to do it
most_recent <- us_films |>
  filter(last_week_number1 == max(last_week_number1, na.rm = TRUE))

datatable(us_films, options = list(searching = FALSE, info = FALSE))
   
```

Question 10: **Which TV show/season hit the top 10 in the most countries in its debut week? In how many countries did it chart?**

```{r}
COUNTRY_TOP_10 |> 
  filter(category == 'TV') |>
  group_by(show_title,country_name) |> 
  summarise(debut_week = min(week), .groups = 'drop') |>
  group_by(show_title, debut_week) |>
  summarise(countries_charted = n_distinct(country_name), .groups = 'drop') |>
  arrange(desc(countries_charted)) |>
  head(5)
```

Stranger things press release code

```{r}
library(dplyr)

# Get Stranger Things total viewership and weeks
st_stats <- GLOBAL_TOP_10 |>
    filter(str_detect(show_title, "Stranger Things")) |>
    summarise(
        total_hours = sum(weekly_hours_viewed, na.rm = TRUE),
        total_weeks = sum(cumulative_weeks_in_top_10, na.rm = TRUE),
        seasons = n_distinct(show_title)
    )

# Get country reach
st_countries <- COUNTRY_TOP_10 |>
    filter(str_detect(show_title, "Stranger Things")) |>
    summarise(countries = n_distinct(country_name))

# Compare to other popular English TV shows
tv_comparison <- GLOBAL_TOP_10 |>
    filter(str_detect(category, "TV"),
           str_detect(category, "English")) |>
    group_by(show_title) |>
    summarise(
        total_hours = sum(weekly_hours_viewed, na.rm = TRUE),
        total_weeks = max(cumulative_weeks_in_top_10, na.rm = TRUE),
        .groups = "drop"
    ) |>
    arrange(desc(total_hours)) |>
    head(10)

# Check Stranger Things ranking
st_ranking <- tv_comparison |>
    mutate(rank = row_number()) |>
    filter(str_detect(show_title, "Stranger Things"))



```

## The Wait Is Almost Over: *Stranger Things* Returns for Epic Final Season in Late 2025

### Global Phenomenon Captivates Nearly 3 Billion Hours of Viewership Across 93 Countries as Netflix Prepares for Series Finale

**LOS GATOS, Calif. –** October 1, 2025 – Netflix today announced that Stranger Things, one of the most-watched English-language series in Netflix history, will conclude with its highly anticipated fifth and final season arriving later this year. As fans prepare to say goodbye to Eleven, Mike, Dustin, and the rest of the Hawkins crew, the streaming giant is celebrating the unprecedented global success of the beloved sci-fi drama.

Since its debut, Stranger Things has amassed an astounding 2.97 billion hours viewed globally, cementing its place as the third most-watched English-language TV series in Netflix history. The show's cultural impact has transcended borders, captivating audiences in 93 countries and maintaining a presence in the Netflix Top 10 for 19 consecutive weeks across its four seasons.

Season 5 promises to deliver an epic conclusion to the story that began in 2016, bringing closure to beloved character arcs while delivering the monster-fighting fans have come to expect. The Duffer Brothers have promised that this final season will be their most ambitious yet, with higher stakes, deeper emotional moments, and answers to the fan theories that have captivated viewers for nearly a decade.

As the world prepares to return to Hawkins one last time, Stranger Things stands as a power of compelling storytelling, memorable characters, and the magic that happens when a show captures the hearts of audiences around the globe.

*Stranger Things* Season 5 will premiere on Netflix in late 2025.

## 

# Netflix India Shatters Records: Hindi Content Dominates as Subscriber Engagement Surges

**MUMBAI, India** – Netflix today announced extraordinary performance in India, where Hindi-language films and series have achieved unprecedented staying power in the platform's Top 10 charts. Hindi films have proven particularly resilient, with romantic thriller Haseen Dillruba maintaining its Top 10 position for twenty-one consecutive weeks and action blockbuster Sooryavanshi captivating audiences for twenty weeks. Recent releases continue this momentum: Animal dominated for seventeen weeks, Lucky Baskhar held strong for seventeen weeks, and Kiran Rao's critically acclaimed Laapataa Ladies sustained fifteen weeks of viewership. Television series have proven equally compelling, with The Railway Men - The Untold Story of Bhopal 1984 remaining in India's Top 10 for thirty weeks and crime thriller Khakee: The Bihar Chapter holding viewers for twenty-nine weeks.

The platform's expansion reflects remarkable growth in content diversity and subscriber engagement. In the third quarter of 2021, eighty unique titles appeared in India's weekly Top 10 charts. By the fourth quarter of 2023, that number had surged to one hundred eight titles, representing thirty-five percent growth. This expansion demonstrates both Netflix's increased investment in Indian originals and the sophisticated, varied tastes of Indian subscribers who consume everything from regional blockbusters like RRR (Hindi) to international phenomenons like Money Heist, which achieved forty-eight weeks in India's Top 10, and Squid Game, which maintained forty-three weeks.

India represents one of our most dynamic and fastest-growing markets, said a Netflix spokesperson. The data tells an undeniable story: Indian audiences are embracing both homegrown storytelling and global content with unprecedented enthusiasm. Films like Haseen Dillruba and Sooryavanshi achieve massive popularity in India without charting in the United States, proving our ability to serve India's unique cultural tastes while also connecting Indian viewers with the world's best stories. As the world's most populous nation continues its digital transformation, we're committed to expanding our investment in authentic Indian content across Hindi and regional languages.

```{r}

# India content analysis
india_content <- COUNTRY_TOP_10 |>
  filter(country_name == "India") |>
  group_by(show_title, category) |>
  summarize(
    weeks_in_top10 = max(cumulative_weeks_in_top_10),
    total_appearances = n(),
    .groups = "drop"
  ) |>
  arrange(desc(weeks_in_top10))

# US titles for comparison
us_titles <- COUNTRY_TOP_10 |>
  filter(country_name == "United States") |>
  distinct(show_title)

# India-exclusive films
india_only <- india_content |>
  anti_join(us_titles, by = "show_title") |>
  filter(str_detect(category, "Films")) |>
  head(10)

# Quarterly growth
india_quarterly <- COUNTRY_TOP_10 |>
  filter(country_name == "India") |>
  mutate(year = year(week), quarter = quarter(week)) |>
  group_by(year, quarter) |>
  summarize(
    unique_titles = n_distinct(show_title),
    .groups = "drop"
  )


```

# **Korean Wave Sweeps Southeast Asia: Netflix K-Dramas Achieve Record 42-Week Runs as Regional Engagement Surges**

**SINGAPORE** – Netflix today celebrated the extraordinary performance of Korean-language content across Southeast Asian markets, where K-dramas have achieved unprecedented staying power throughout 2024. The fantasy romance Alchemy of Souls dominated regional Top 10 charts for forty-two consecutive weeks across all six major Southeast Asian markets—Malaysia, Singapore, Thailand, the Philippines, Vietnam, and Indonesia. Other Korean hits demonstrated similar longevity: Crash Landing on You captivated audiences for thirty-five weeks across five countries, Hometown Cha-Cha-Cha held strong for thirty-one weeks, and legal drama Extraordinary Attorney Woo maintained twenty-four weeks of viewership. This sustained engagement far exceeds typical content lifecycles and reflects genuine cross-cultural connection with Korean storytelling.

The breadth of successful Korean content reveals sophisticated audience tastes spanning multiple genres. Action thriller Vincenzo entertained viewers for twenty-nine weeks, while animated series Solo Leveling achieved twenty-seven weeks and Taxi Driver held attention for twenty-three weeks. Japanese anime also found receptive audiences, with Jujutsu Kaisen and Demon Slayer: Kimetsu no Yaiba each maintaining twenty-two and twenty-one weeks respectively. Romantic comedy Business Proposal rounded out the top performers with twenty-one weeks across six countries. This diversity demonstrates that Southeast Asian audiences embrace compelling narratives regardless of origin, creating a vibrant pan-Asian entertainment ecosystem.

Southeast Asian markets showed robust growth in overall content consumption, with unique titles appearing in weekly Top 10 charts expanding from eight hundred sixty-four in 2023 to nine hundred fourteen in 2024, representing nearly six percent year-over-year growth. This expansion reflects both Netflix's increased investment in Asian content and growing subscriber bases across the region's combined population of over six hundred seventy million people. The platform's ability to connect Korean creators with passionate Southeast Asian audiences validates its strategy of investing in diverse, quality content that transcends borders and language barriers.

```{r}

# Define Southeast Asian countries
southeast_asia <- c("Malaysia", "Singapore", "Thailand", "Philippines", "Vietnam", "Indonesia")

# Find K-dramas popular across SEA
sea_kdrama <- COUNTRY_TOP_10 |>
  filter(country_name %in% southeast_asia,
         str_detect(category, "TV")) |>
  group_by(show_title) |>
  summarize(
    sea_countries = n_distinct(country_name),
    max_weeks = max(cumulative_weeks_in_top_10),
    .groups = "drop"
  ) |>
  filter(sea_countries >= 4) |>
  arrange(desc(max_weeks)) |>
  head(15)

# Year-over-year growth in SEA
sea_growth <- COUNTRY_TOP_10 |>
  filter(country_name %in% southeast_asia) |>
  mutate(year = year(week)) |>
  filter(year %in% c(2023, 2024)) |>
  group_by(year) |>
  summarize(
    total_unique_titles = n_distinct(show_title),
    .groups = "drop"
  )

# Top performers
top_performers <- tibble(
  Title = c("Alchemy of Souls", "Crash Landing on You", "Hometown Cha-Cha-Cha", 
            "Vincenzo", "Extraordinary Attorney Woo", "Business Proposal"),
  Weeks = c(42, 35, 31, 29, 24, 21),
  Countries = c(6, 5, 6, 6, 6, 6)
)




```
